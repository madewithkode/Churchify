<!DOCTYPE html>
<html class="no-js" lang="en">
<head>

    <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <title>Dashboard Admin |Churchify Portal</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" type="text/css" href="static/css/login-form.css">
    <link rel="stylesheet" href="static/css/base.css">
    <link rel="stylesheet" href="static/css/main.css">
    <link rel="stylesheet" href="static/css/bootstrap/bootstrap.min.css">
    <!-- script
    ================================================== -->
    <script src="static/js/modernizr.js"></script>
    <script src="static/js/pace.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="static/js/bootstrap.min.js"></script>


    <!-- favicons
    ================================================== -->
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    
</head>

<body id="top">

    <!-- header
    ================================================== -->
    <header class="s-header">

        <div class="header-logo">
            <a class="site-logo" href="/">
                <h1 class="force-logo" style="color:white;">
                    Churchify Portal 
                </h1>
                <!--<img src="static/images/logo.svg" alt="Homepage">-->
            </a>
        </div> <!-- end header-logo -->

        <nav class="header-nav">

            <a href="#0" class="header-nav__close" title="close"><span>Close</span></a>

            <div class="header-nav__content">
                <h3>Churchify Portal</h3>
                
                <ul class="header-nav__list">
                    <li class="current"><a href="/" title="Home">Home</a></li>
                    <li><a href="/deacon-login" title="Deacon">Deacon</a></li>
                    <li><a href="/cd-login" title="Coordinator">Coordinator</a></li>
                    <li><a href="cg-login" title="CareGroup">Caregroup</a></li>
                    <li><a href="/admin-logout" title="Logout">Logout</a></li>
                </ul>
    
                <p>Perspiciatis hic praesentium nesciunt. Et neque a dolorum <a href='#0'>voluptatem</a> porro iusto sequi veritatis libero enim. Iusto id suscipit veritatis neque reprehenderit.</p>
    
                <ul class="header-nav__social">
                    <li>
                        <a href="#0"><i class="fab fa-facebook"></i></a>
                    </li>
                    <li>
                        <a href="#0"><i class="fab fa-twitter"></i></a>
                    </li>
                    <li>
                        <a href="#0"><i class="fab fa-instagram"></i></a>
                    </li>
                    <li>
                        <a href="#0"><i class="fab fa-behance"></i></a>
                    </li>
                    <li>
                        <a href="#0"><i class="fab fa-dribbble"></i></a>
                    </li>
                </ul>

            </div> <!-- end header-nav__content -->

        </nav> <!-- end header-nav -->

        <a class="header-menu-toggle" href="#0">
            <span class="header-menu-icon"></span>
        </a>

    </header> <!-- end s-header -->


    <!-- home
    ================================================== -->
    <section id="home" class="s-home target-section" data-parallax="scroll" data-image-src="static/images/sarah2.jpg" data-natural-width=3000 data-natural-height=2000 data-position-y=top>

        <div class="shadow-overlay"></div>

        <div class="home-content">

            <div class="my-row  home-content__main">
                <h1>
                Admin Dashboard 
                </h1>

            </div> <!-- end home-content__main -->

        </div> <!-- end home-content -->

        <ul class="home-sidelinks">
            <li><a href="/deacon-login">Deacon<span></span></a></li>
            <li><a href="/cd-login">Coordinator<span></span></a></li>
            <li><a href="/cg-login">CareGroup<span></span></a></li>
            <li><a href="/admin-logout">Logout<span></span></a></li>
        </ul> <!-- end home-sidelinks -->


        <ul class="home-social">
            <li class="home-social-title">Follow Us</li>
            <li><a href="#0">
                <i class="fab fa-facebook"></i>
                <span class="home-social-text">Facebook</span>
            </a></li>
            <li><a href="#0">
                <i class="fab fa-twitter"></i>
                <span class="home-social-text">Twitter</span>
            </a></li>
            <li><a href="#0">
                <i class="fab fa-linkedin"></i>
                <span class="home-social-text">LinkedIn</span>
            </a></li>
        </ul> <!-- end home-social -->

        <a href="#about" class="home-scroll smoothscroll">
            <span class="home-scroll__text">Scroll Down</span>
            <span class="home-scroll__icon"></span>
        </a> <!-- end home-scroll -->

    </section> <!-- end s-home -->
                         
    <section class="tab-section">
        <div class="tab">
            <button class="tablinks" onclick="openCity(event, 'London')" id="defaultOpen">Enter Visitor's Data</button>
            <button id="all-visitors" class="tablinks" onclick="openCity(event, 'Paris')">View All Visitors</button>
        </div>
          
        <div id="London" class="tabcontent container-fluid">
            <div id="error-message" class="error-message"></div>
            <div id="success-message" class="success-message"></div>
            <form class="visitors-form" id="visitors-form">
                    {{ form.csrf_token }}
                    {{ form.hidden_tag() }}
                <div class="row section-header" data-aos="fade-up">
                    <div class="col-full">
                        <h1 class="text-center">Personal Data.</h1>
                    </div>
                    <div class="form-inline container">
                        <div class="form-group form-control">
                            <label for="inputEmail4">Full Name</label>
                            {{ form.fullname(class_="form-control") }}
                        </div>
                        <div class="form-group form-control">
                            <label for="inputEmail">Phone</label>
                            {{ form.phone(class_="form-control") }}
                        </div>
                        <div class="form-group form-control ">
                            <label for="inputEmail4">Address</label>
                            {{ form.address(class_="form-control") }}
                        </div>
                        <div class="form-group form-control">
                            <label for="inputCity">Place of work</label>
                            {{ form.workPlace(class_="form-control") }}
                        </div>
                        <div class="form-group form-control">
                            <label for="inputEmail4">Sex</label>
                            <select name="select_sex" id="sex" class="my-form-control">
                                {% for sex in sex %}
                                <option value="{{ sex }}">{{ sex }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group form-control">
                            <label for="inputState">Marital Status</label>
                            <select name="select_status"id="status" class="my-form-control">
                                {% for status in maritalStatus %}
                                <option value="{{ status }}">{{ status }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group form-control">
                            <label for="inputState">Age</label>
                            <select name="select_age"id="age" class="my-form-control">
                                {% for age in age %}
                                <option value="{{ age }}">{{ age }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group form-control">
                            <label for="inputState">Edu. Qualification</label>
                            <select id="edQual" name="select_edQual" class="my-form-control">
                                  {% for qualification in edQual %}
                                  <option value="{{ qualification }}">{{ qualification }}</option>
                                  {% endfor %}
                            </select>
                        </div>
                        <div class="form-group form-control">
                            <label for="inputEmail4">Assign Zonal Deacon</label>
                            <select name="select_deacon" id="deacon" class="my-form-control">
                                {% for deacon in zDeac %}
                                <option value="{{ deacon }}">{{ deacon }}</option>
                                {% endfor %}
                            </select>
                        </div> 
                        <div class="form-group form-control" style="height:80px; width:100px;">
                            <label for="inputEmail4">Visitor</label>
                            {{ form.visitor(style="padding-left: 0px;padding-right: 0px;margin-left: 31px;margin-right: 31px;") }}
                        </div>
                        <div class="form-group form-control" style="height:80px; width:100px;">
                            <label for="inputEmail4">Counselee</label>
                            {{ form.counselee(style="padding-left: 0px;padding-right: 0px;margin-left: 31px;margin-right: 31px;") }}
                        </div>
                    </div>
                
                    <div class="row section-header container" data-aos="fade-up">
                        <div class="col-full">
                            <h1 style="color:black;padding-left: 17px;">Spiritual Data.</h1>
                        </div>
                        <div class="form-inline container">
                            <div class="form-group form-control">
                                <label for="inputEmail4">Salvation</label>
                                {{ form.salvation() }}
                              </div>
                              <div class="form-group form-control">
                                <label for="inputEmail4">Rededicaton</label>
                                {{ form.rededication() }}
                              </div>
                              <div class="form-group form-control">
                                <label for="inputEmail4">BHS</label>
                                {{ form.bhs() }}
                              </div>
                              
                        </div>
                        <div class="col-full">
                            <h1 style="color:black;padding-left: 17px;">Like to join FWC?</h1>
                        </div>
                        <div class="form-inline container">
                            {% for choice in form.joinFWC %}
                            <div class="form-group form-control">
                                <div class="my-form-control col-md-6">
                                {{ choice.label }}
                                {{ choice }}
                                </div>
                            </div>
                            {% endfor %}
                        <div class="col-full" style="padding-left: 0px;">
                            <h1 style="color:black;">Prayer Needs</h1>
                        </div>
                        <div class="form-row">
                            <div class="form-group col-md-12">
                                {{ form.prayerNeeds() }}
                            </div>
                        </div>        
                            <div class="container">
                                <input style="margin-left: -17px;" type="submit" id="visitors-form" class="text-center">
                            </div>
                        </div>
                    </div>
                </div>
            </form>
          </div>
          <div id="Paris" class="tabcontent table-responsive container-fluid">
            <h2 class="text-center" style="color:black;">All Visitors Data</h2>
            <table class="table table-bordered">
                <thead>
                    <tr>
                    <th>Fullname</th>
                    <th>Phone</th>
                    <th>Address</th>
                    <th>Sex</th>
                    <th>Age</th>
                    <th>Visitor</th>
                    <th>Counselee</th>
                    <th>Deacon Assigned</th>
                    <th>Coordinator Assigned</th>
                    <th>Caregroup Lead Assigned</th>
                    <th>Visit Status</th>
                    <th>Visit Remarks</th>
                    </tr>
                </thead>
                <tbody>
                    {% for row in data %}
                    <tr>
                        {% for d in row %}
                            <td>{{ d }}</td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
                <div class="text-center">
                    <input id="refresh" type="button" value="Refresh">
                </div> 
          </div>
    </section>


    <!-- stats
    ================================================== -->
    <section id="stats" class="s-stats">

        <div class="row stats block-1-4 block-m-1-2 block-mob-full" data-aos="fade-up">
                
            <div class="col-block stats__col ">
                <div class="stats__count">{{totalVisitors}}</div>
                    <h5>Visitor(s) Received</h5>
                </div>
                <div class="col-block stats__col">
                    <div class="stats__count">{{totalCounselees}}</div>
                    <h5>Counselee(s) Received</h5>
                </div>
                <div class="col-block stats__col">
                    <div class="stats__count">{{totalVisits}}</div>
                    <h5>Success Follow-Ups</h5>
                </div>
                <div class="col-block stats__col">
                    <div class="stats__count">{{totalNotVisited}}</div>
                    <h5>Unsuccessful Follow-Ups</h5> 
                </div>

        </div> <!-- end stats -->

    </section> <!-- end s-stats -->
    
    <!-- preloader
    ================================================== -->
    <div id="preloader">
        <div id="loader">            
        </div>
    </div>
    

    <!-- Java Script
    ================================================== -->

<script>

  $(document).ready(function() {
    $('#refresh').click(function() {
        location.reload(true)
        //$('#Paris').load('/admin-panel'); 
    });  
    $('form').submit(function (e) {
        var url = "/submit-visitor"; // send the form data here.
        $.ajax({
            type: "POST",
            url: url,
            data: $('form').serialize(), // serializes the form's elements.
            success: function (data) {
                console.log(data)  // display the returned data in the console.
                newData = JSON.stringify(data)
                newData = newData.replace(/data/gi,"")
                newData = newData.replace(/{/gi,"")
                newData = newData.replace(/}/gi,"")
                newData = newData.replace(/"/gi,"")
                newData = newData.replace(/:/gi,"")
                if (newData == "Fields marked required must be filled out"){
                    $("#success-message").hide();
                    $("#error-message").show();
                    $('#error-message').text(newData);
                    $('#visitors-form').trigger("reset");  
                    $('html, body').animate({
                        scrollTop: $("#error-message").offset().top
                    }, 700);
                }else if(newData == "Visitor added Successfully") {
                    $("#error-message").hide();
                    $("#success-message").show();
                    $('#success-message').text(newData);
                    $('#visitors-form').trigger("reset");  
                    $('html, body').animate({
                        scrollTop: $("#success-message").offset().top
                    }, 700);
                }
            }
        });
        e.preventDefault(); // block the traditional submission of the form.
    });
    // Inject our CSRF token into our AJAX request.
    $.ajaxSetup({
        beforeSend: function(xhr, settings) {
            if (!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", "{{ form.csrf_token._value() }}")
            }
        }
    })
  });
</script>

    <script src="static/js/jquery-3.2.1.min.js"></script>
    <script src="static/js/plugins.js"></script>
    <script src="static/js/main.js"></script>
<!--===============================================================================================-->
    <script src="static/js/tabbed-form.js"></script>
    

</body>

</html>